---
title: 受信任的平台模块 (TPM)
ms.date: 08/28/2017
ms.topic: article
ms.prod: windows-iot
ms.technology: iot
description: 了解如何使用受信任的平台模块启用加密功能，从而更好地保护设备。
keywords: windows iot，安全性，受信任的平台模块，TPM，加密，密钥
ms.openlocfilehash: 2459503eab215ae5c7f24a2f066039c0aa36918f
ms.sourcegitcommit: c57cebdf4d083079f41ec92ef65d897fd3c0faf8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/02/2020
ms.locfileid: "91657193"
---
# <a name="trusted-platform-module-tpm-on-windows-10-iot-core"></a><span data-ttu-id="3a0b1-104">受信任的平台模块 (Windows 10 IoT Core 上的 TPM) </span><span class="sxs-lookup"><span data-stu-id="3a0b1-104">Trusted Platform Module (TPM) on Windows 10 IoT Core</span></span>

## <a name="what-is-tpm"></a><span data-ttu-id="3a0b1-105">什么是 TPM？</span><span class="sxs-lookup"><span data-stu-id="3a0b1-105">What is TPM?</span></span>
<span data-ttu-id="3a0b1-106">受信任的平台模块 (TPM) ，是一种加密协处理器，其中包括用于随机编号生成的功能、安全生成的加密密钥和其使用限制。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-106">A Trusted Platform Module (TPM), is a cryptographic coprocessor including capabilities for random number generation, secure generation of cryptographic keys and limitation of their use.</span></span> <span data-ttu-id="3a0b1-107">它还包括远程证明和密封的存储等功能。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-107">It also includes capabilities such as remote attestation and sealed storage.</span></span>
<span data-ttu-id="3a0b1-108">TPM 的技术规范是公开发布的，由受信任的计算组驱动 (TCG) 。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-108">TPM's technical specification is publicly available, driven by the Trusted Computing Group (TCG).</span></span> <span data-ttu-id="3a0b1-109">2.0 年 10) 2014 月发布的最新版本 TPM (，它是一种用于添加新功能并修复以前的 TPM 1.2 弱点的规范的主要重新设计。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-109">The latest version TPM 2.0 (released October 2014), is a major redesign of the specification that adds new functionality and fixes weaknesses of the former TPM 1.2.</span></span>

## <a name="why-tpm"></a><span data-ttu-id="3a0b1-110">为什么选择 TPM？</span><span class="sxs-lookup"><span data-stu-id="3a0b1-110">Why TPM?</span></span>  
<span data-ttu-id="3a0b1-111">合并 TPM 的计算机可以创建加密密钥并对其进行加密，以便只能由 TPM 进行解密。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-111">Computers that incorporate a TPM can create cryptographic keys and encrypt them so that they can only be decrypted by the TPM.</span></span> <span data-ttu-id="3a0b1-112">此过程通常称为 **"覆盖** " 或 **"绑定"** 密钥，可帮助防止密钥泄漏。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-112">This process, often called **"wrapping"** or **"binding"** a key, can help protect the key from disclosure.</span></span> <span data-ttu-id="3a0b1-113">每个 TPM 都有一个名为 "包装" 的主密钥，它存储在 TPM 本身中。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-113">Each TPM has a primary "wrapping" key, called the storage root key, which is stored within the TPM itself.</span></span> <span data-ttu-id="3a0b1-114">在 TPM 中创建的密钥的隐私部分从不暴露给其他组件、软件、进程或者人员。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-114">The private portion of a key created in a TPM is never exposed to any other component, software, process, or person.</span></span>  

<span data-ttu-id="3a0b1-115">合并了 TPM 的计算机还可以创建一个密钥，该密钥不仅被包装，而且还与特定的平台测量相关。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-115">Computers that incorporate a TPM can also create a key that has not only been wrapped but is also tied to certain platform measurements.</span></span> <span data-ttu-id="3a0b1-116">只有在那些平台度量具有的值与创建该密钥时具有的值相同时，才能取消覆盖这种类型的密钥。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-116">This type of key can only be unwrapped when those platform measurements have the same values that they had when the key was created.</span></span> <span data-ttu-id="3a0b1-117">此过程称为将密钥 **"密封"** 到 TPM。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-117">This process is called **"sealing"** the key to the TPM.</span></span> <span data-ttu-id="3a0b1-118">解密密钥称为 **"解封"**。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-118">Decrypting the key is called **"unsealing"**.</span></span> <span data-ttu-id="3a0b1-119">TPM 还可以对在 TPM 外部生成的数据进行密封和解封。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-119">The TPM can also seal and unseal data generated outside of the TPM.</span></span> <span data-ttu-id="3a0b1-120">利用此密封密钥和软件（如 BitLocker 驱动器加密），可以在满足特定硬件或软件条件之前锁定数据。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-120">With this sealed key and software such as BitLocker Drive Encryption, you can lock data until specific hardware or software conditions are met.</span></span>  

<span data-ttu-id="3a0b1-121">使用 TPM 时，密钥对的专用部分与操作系统控制的内存保持独立。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-121">With a TPM, private portions of key pairs are kept separate from the memory controlled by the operating system.</span></span> <span data-ttu-id="3a0b1-122">可以将密钥密封到 TPM，并对系统的状态进行一些保证，即，确定) 系统的 "可信任性" 的系统 (保证，在未密封密钥并将其释放以便使用之前。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-122">Keys can be sealed to the TPM, and certain assurances about the state of a system (assurances that define the "trustworthiness" of a system) can be made before the keys are unsealed and released for use.</span></span> <span data-ttu-id="3a0b1-123">因为 TPM 使用自身的内部固件和逻辑电路来处理指令，所以它不依赖于操作系统，也不会受操作系统或应用程序中可能存在的漏洞影响。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-123">Because the TPM uses its own internal firmware and logic circuits for processing instructions, it does not rely on the operating system and is not exposed to vulnerabilities that might exist in the operating system or application software.</span></span>

## <a name="tpm-architecture"></a><span data-ttu-id="3a0b1-124">TPM 体系结构</span><span class="sxs-lookup"><span data-stu-id="3a0b1-124">TPM Architecture</span></span>
<span data-ttu-id="3a0b1-125">_TPM 1.2 与 TPM 2.0 之间的差异。_</span><span class="sxs-lookup"><span data-stu-id="3a0b1-125">_Difference between TPM 1.2 and TPM 2.0._</span></span>  
<span data-ttu-id="3a0b1-126">TPM 规范开发了两次。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-126">The TPM specification has been developed twice.</span></span> <span data-ttu-id="3a0b1-127">第一次是从 1.1 b 开发到1.2，其中包含由规范委员会请求/确定的新功能。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-127">The first time, it developed from 1.1b to 1.2, incorporating  new capabilities requested/identified by the specification committee.</span></span> <span data-ttu-id="3a0b1-128">此功能爬出形式的演变使得最终的 TPM 1.2 规范非常复杂。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-128">This feature-creep form of evolution made the final TPM 1.2 specification very complicated.</span></span> <span data-ttu-id="3a0b1-129">最后，SHA-1 (的加密漏洞是 TPM 1.2) 中最强大的商业算法，这会导致需要进行更改。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-129">Eventually, cryptographic weaknesses of SHA-1 (which was the strongest commercial algorithm in TPM 1.2) were revealed which caused the need for a change.</span></span> <span data-ttu-id="3a0b1-130">TPM 体系结构从头开始重新设计，导致 TPM 2.0 的集成和统一设计更加紧密。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-130">The TPM architecture was redesigned from scratch, resulting in the much more integrated and unified design of TPM 2.0.</span></span>  

<span data-ttu-id="3a0b1-131">与以前的 TPM 1.2 相比，更改和增强包括：</span><span class="sxs-lookup"><span data-stu-id="3a0b1-131">The changes and enhancements compared to the previous TPM 1.2 include:</span></span>

* <span data-ttu-id="3a0b1-132">支持其他加密算法</span><span class="sxs-lookup"><span data-stu-id="3a0b1-132">Support for additional cryptographic algorithms</span></span>
* <span data-ttu-id="3a0b1-133">对应用程序的 TPM 可用性的增强</span><span class="sxs-lookup"><span data-stu-id="3a0b1-133">Enhancements to the availability of the TPM to applications</span></span>
* <span data-ttu-id="3a0b1-134">增强的授权机制</span><span class="sxs-lookup"><span data-stu-id="3a0b1-134">Enhanced authorization mechanisms</span></span>
* <span data-ttu-id="3a0b1-135">简化的 TPM 管理</span><span class="sxs-lookup"><span data-stu-id="3a0b1-135">Simplified TPM management</span></span>
* <span data-ttu-id="3a0b1-136">增强了平台服务安全性的附加功能</span><span class="sxs-lookup"><span data-stu-id="3a0b1-136">Additional capabilities to enhance the security of platform services</span></span>

> [!NOTE] 
> <span data-ttu-id="3a0b1-137">Windows IoT Core 仅支持 TPM 2.0，并且不支持过时的 TPM 1.2。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-137">Windows IoT Core supports only TPM 2.0 and does not support the outdated TPM 1.2.</span></span>

## <a name="what-is-tbs"></a><span data-ttu-id="3a0b1-138">什么是 TBS？</span><span class="sxs-lookup"><span data-stu-id="3a0b1-138">What is TBS?</span></span> 
<span data-ttu-id="3a0b1-139">TPM 基本服务 (TB) 功能是允许对 TPM 资源进行透明共享的系统服务。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-139">The TPM Base Services (TBS) feature is a system service that allows transparent sharing of the TPM resources.</span></span> <span data-ttu-id="3a0b1-140">它通过远程过程调用 (RPC) 来共享同一物理计算机上多个应用程序中的 TPM 资源。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-140">It shares the TPM resources among multiple applications on the same physical machine through remote procedure calls (RPC).</span></span> <span data-ttu-id="3a0b1-141">它使用调用应用程序指定的优先级跨应用程序集中访问 TPM。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-141">It centralizes TPM access across applications using priorities specified by the calling applications.</span></span>  

<span data-ttu-id="3a0b1-142">TPM 提供旨在在平台中提供信任的加密功能。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-142">The TPM provides cryptographic functions designed to provide trust in the platform.</span></span> <span data-ttu-id="3a0b1-143">由于 TPM 是在硬件中实现的，因此它具有有限的资源。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-143">Because the TPM is implemented in hardware, it has finite resources.</span></span> <span data-ttu-id="3a0b1-144">TCG 定义 TPM 软件堆栈 (TSS) ，它利用这些资源为应用程序软件提供受信任的操作。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-144">The TCG defines a TPM Software Stack (TSS) that makes use of these resources to provide trusted operations for application software.</span></span> <span data-ttu-id="3a0b1-145">但是，并不是为了与可能使用 TPM 资源的操作系统软件并行运行 TSS 实现。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-145">However, no provision is made for running a TSS implementation side by side with operating system software that may also be using TPM resources.</span></span> <span data-ttu-id="3a0b1-146">TBS 功能通过以下方式解决了这一问题：启用每个与 TBS 通信的软件堆栈，以将 TPM 资源检查用于计算机上可能正在运行的任何其他软件堆栈。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-146">The TBS feature solves this problem by enabling each software stack that communicates with TBS to use TPM resources checking for any other software stacks that may be running on the machine.</span></span>

## <a name="tpm-solutions-available-on-windows-iot-core"></a><span data-ttu-id="3a0b1-147">Windows IoT Core 上提供的 TPM 解决方案</span><span class="sxs-lookup"><span data-stu-id="3a0b1-147">TPM solutions available on Windows IoT Core</span></span>  
<span data-ttu-id="3a0b1-148">_一些有关软件 TPM (sTPM) ，固件 TPM (fTPM) ，离散 TPM (dTPM) .。。_</span><span class="sxs-lookup"><span data-stu-id="3a0b1-148">_A few words about Software TPM (sTPM), Firmware TPM (fTPM), Discrete TPM (dTPM)..._</span></span>

### <a name="firmware-tpm-ftpm"></a><span data-ttu-id="3a0b1-149">固件 TPM (fTPM) </span><span class="sxs-lookup"><span data-stu-id="3a0b1-149">Firmware TPM (fTPM)</span></span>  
<span data-ttu-id="3a0b1-150">固件 TPM (fTPM) 需要在 Raspberry Pi 2 或3上当前未实现的特殊处理器/SoC 支持。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-150">Firmware TPM (fTPM) requires special Processor/SoC support that is not currently implemented on Raspberry Pi 2 or 3.</span></span> <span data-ttu-id="3a0b1-151">MinnowBoard 最大要求固件版本0.80 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-151">MinnowBoard Max needs firmware version 0.80 or higher.</span></span> <span data-ttu-id="3a0b1-152">默认情况下，DragonBoard410c 提供已启用的 fTPM 功能。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-152">DragonBoard410c provides fTPM capabilities out of the box enabled by default.</span></span>  

### <a name="discrete-tpm-dtpm"></a><span data-ttu-id="3a0b1-153">独立 TPM (dTPM) </span><span class="sxs-lookup"><span data-stu-id="3a0b1-153">Discrete TPM (dTPM)</span></span>  
<span data-ttu-id="3a0b1-154">所有方法都将独立的 TPM (dTPM) 视为受信任的最佳解决方案。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-154">Discrete TPM (dTPM) is considered the utmost trustworthy solution by all means.</span></span>  
<span data-ttu-id="3a0b1-155">Windows IoT Core 支持多个 dTPM 芯片和 PCB 模块制造商：</span><span class="sxs-lookup"><span data-stu-id="3a0b1-155">There are several manufacturers of dTPM chips and PCB modules that are supported on Windows IoT Core:</span></span>

> | <span data-ttu-id="3a0b1-156">制造商</span><span class="sxs-lookup"><span data-stu-id="3a0b1-156">Manufacturer</span></span> | <span data-ttu-id="3a0b1-157">网页</span><span class="sxs-lookup"><span data-stu-id="3a0b1-157">Web Page</span></span> | <span data-ttu-id="3a0b1-158">Modul 类型</span><span class="sxs-lookup"><span data-stu-id="3a0b1-158">Modul Type</span></span> | <span data-ttu-id="3a0b1-159">TPM 芯片</span><span class="sxs-lookup"><span data-stu-id="3a0b1-159">TPM Chip</span></span> |
> |-------------|----------|----------|----------| 
> | <span data-ttu-id="3a0b1-160">Infineon</span><span class="sxs-lookup"><span data-stu-id="3a0b1-160">Infineon</span></span> | [<span data-ttu-id="3a0b1-161">Infineon TPM</span><span class="sxs-lookup"><span data-stu-id="3a0b1-161">Infineon TPM</span></span>](https://www.infineon.com/cms/en/product/evaluation-boards/iridium9670-tpm2.0-linux/)| <span data-ttu-id="3a0b1-162">Evalboard</span><span class="sxs-lookup"><span data-stu-id="3a0b1-162">Evalboard</span></span> | [<span data-ttu-id="3a0b1-163">Infineon SLB9670 TPM 2。0</span><span class="sxs-lookup"><span data-stu-id="3a0b1-163">Infineon SLB9670 TPM 2.0</span></span>](https://www.infineon.com/cms/de/product/security-smart-card-solutions/optiga-embedded-security-solutions/optiga-tpm/slb-9670vq2.0/) |
> | <span data-ttu-id="3a0b1-164">Pi3g</span><span class="sxs-lookup"><span data-stu-id="3a0b1-164">Pi3g</span></span> | [<span data-ttu-id="3a0b1-165">Pi3g.com</span><span class="sxs-lookup"><span data-stu-id="3a0b1-165">Pi3g.com</span></span>](https://pi3g.com/eigene-produkte/)| <span data-ttu-id="3a0b1-166">批量产品 & Evalboard</span><span class="sxs-lookup"><span data-stu-id="3a0b1-166">Mass Product & Evalboard</span></span> | [<span data-ttu-id="3a0b1-167">Infineon SLB9670 TPM 2。0</span><span class="sxs-lookup"><span data-stu-id="3a0b1-167">Infineon SLB9670 TPM 2.0</span></span>](https://www.infineon.com/cms/de/product/security-smart-card-solutions/optiga-embedded-security-solutions/optiga-tpm/slb-9670vq2.0/) |


### <a name="software-tpm-stpm"></a><span data-ttu-id="3a0b1-168">软件 TPM (sTPM) </span><span class="sxs-lookup"><span data-stu-id="3a0b1-168">Software TPM (sTPM)</span></span>  
<span data-ttu-id="3a0b1-169">软件 TPM (sTPM) 也称为 TPM 模拟器。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-169">Software TPM (sTPM) is also referred to as TPM Simulator.</span></span> <span data-ttu-id="3a0b1-170">它独立于平台，在 Windows IoT Core 上受支持。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-170">It is platform-independent, supported on Windows IoT Core.</span></span>  

> [!NOTE]
> <span data-ttu-id="3a0b1-171">sTPM 仅用于开发目的，不提供任何真正的安全优势。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-171">sTPM is intended for development purposes only and does not provide any real security benefits.</span></span>  


## <a name="samples"></a><span data-ttu-id="3a0b1-172">示例</span><span class="sxs-lookup"><span data-stu-id="3a0b1-172">Samples</span></span>  
<!--
* [TBSSample project C++](https://developer.microsoft.com/en-us/windows/iot/samples/tbssample)
  This tutorial demonstrates how to create a basic C++ application that uses TBS to poll the TPM.  -->
* <span data-ttu-id="3a0b1-173">[Urchin 库示例](https://github.com/ms-iot/security/tree/master/Urchin/Lib) 本教程演示如何创建一个使用 [Urchin 库](https://github.com/ms-iot/security)来演练 TPM 功能的示例 c + + 应用程序。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-173">[Urchin Library Sample](https://github.com/ms-iot/security/tree/master/Urchin/Lib) This tutorial demonstrates how to create a sample C++ application that exercises the TPM functionality using the [Urchin library](https://github.com/ms-iot/security).</span></span> <span data-ttu-id="3a0b1-174">Urchin 是一个符合规范的库，它派生自 TPM 2.0 参考实现。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-174">Urchin is a spec-compliant library derived from the TPM 2.0 reference implementation.</span></span> <span data-ttu-id="3a0b1-175">它向客户端提供封送/取消封送所有数据结构、正确计算授权、执行参数加密和审核的功能。</span><span class="sxs-lookup"><span data-stu-id="3a0b1-175">It provides to the client the functionality to marshal/unmarshal all data structures, properly calculate authorizations, perform parameter encryption and do auditing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3a0b1-176">其他资源</span><span class="sxs-lookup"><span data-stu-id="3a0b1-176">Additional Resources</span></span>  
* [<span data-ttu-id="3a0b1-177">受信任的平台模块 (TPM) 规范</span><span class="sxs-lookup"><span data-stu-id="3a0b1-177">Trusted Platform Module (TPM) Specifications</span></span>](http://www.trustedcomputinggroup.org/developers/trusted_platform_module) 
* [<span data-ttu-id="3a0b1-178">TCG TPM 2.0 库规范</span><span class="sxs-lookup"><span data-stu-id="3a0b1-178">TCG TPM 2.0 Library Specification</span></span>](http://www.trustedcomputinggroup.org/resources/tpm_library_specification)
* <span data-ttu-id="3a0b1-179">[TPM 基本服务](https://msdn.microsoft.com/library/windows/desktop/aa446796(v=vs.85).aspx)</span><span class="sxs-lookup"><span data-stu-id="3a0b1-179">[TPM Base Services](https://msdn.microsoft.com/library/windows/desktop/aa446796(v=vs.85).aspx)</span></span> 
* [<span data-ttu-id="3a0b1-180">启用安全启动和 BitLocker</span><span class="sxs-lookup"><span data-stu-id="3a0b1-180">Enabling Secure Boot and BitLocker</span></span>](SecureBootAndBitLocker.md)

